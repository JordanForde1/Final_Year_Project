<!-- Reference: https://docs.djangoproject.com/en/1.11/intro/ -->
<!-- Reference: https://www.w3schools.com/w3css/w3css_animate.asp -->
<!-- Reference: https://www.google.com/recaptcha/intro/android.html -->
<!-- Reference: https://bootsnipp.com/snippets/featured/funky-radio-buttons -->

<!-- all necessary links needed for various library -->
<head>
   <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
   <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
   <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
   <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
   <script src='https://www.google.com/recaptcha/api.js'></script>
</head>

<!-- heading of the page -->
<div class="container" id="title">
   <div class="row">
      <div class="page-header">
         <div class="w3-container w3-center w3-animate-opacity">
            <h1>{{ object.question_text }}</h1>
         </div>
      </div>
   </div>
</div>
<hr />

<body>

    <!-- if there are no questions -->
   {% if error_message %}
   <p><strong>{{ error_message }}</strong></p>
   {% endif %}
    <!-- The form to be filled out anonymously by the users -->
   <form action="{% url 'polls:vote' question_id=object.id %}" method="post" name="frm" onsubmit="validateForm()" id="form">
      <div class="funkyradio">

         <!-- protection against Cross Site Request Forgeries -->
         {% csrf_token %}

         <!-- flex box is being used to format the radio buttons -->
         <div class="flex-container">

            <!-- Display the radio buttons to let users vote -->
            <strong class="w3-animate-opacity">Vote:</strong><br />
            {% for choice in object.choice_set.all|dictsortreversed:"id" %}
            <div class="funkyradio-success w3-animate-opacity" style="width: 250px">
               <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.id }}" />
               <label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label>
            </div>
            {% endfor %}
            <br />

            <!-- Display the radio buttons to let users vote -->
            <strong class="w3-animate-opacity">Gender:</strong><br />
            {% for gender in object.gender_set.all|dictsortreversed:"id" %}
            <div class="funkyradio-success w3-animate-opacity" style="width: 250px">
               <input type="radio" name="gender" id="gender{{ forloop.counter }}" value="{{ gender.id }}" />
               <label for="gender{{ forloop.counter }}">{{ gender.gender_text }}</label><br />
            </div>
            {% endfor %}
            <br />

            <!-- Display the radio buttons to let users vote -->
            <strong class="w3-animate-opacity">Age:</strong><br />
            {% for age in object.age_set.all|dictsortreversed:"id" %}
            <div class="funkyradio-success w3-animate-opacity" style="width: 250px">
               <input type="radio" name="age" id="age{{ forloop.counter }}" value="{{ age.id }}" />
               <label for="age{{ forloop.counter }}">{{ age.age_text }} </label><br />
            </div>
            {% endfor %}
            <br />

            <!-- Display the radio buttons to let users vote -->
            <strong class="w3-animate-opacity">Education: (Highest Achieved)</strong><br />
            {% for education in object.education_set.all|dictsortreversed:"id" %}
            <div class="funkyradio-success w3-animate-opacity" style="width: 250px">
               <input type="radio" name="education" id="education{{ forloop.counter }}" value="{{ education.id }}" />
               <label for="education{{ forloop.counter }}">{{ education.education_text }}</label><br />
            </div>
            {% endfor %}
            <br />

            <!-- Display the radio buttons to let users vote -->
            <strong class="w3-animate-opacity">Religion:</strong><br />
            {% for religion in object.religion_set.all|dictsortreversed:"id" %}
            <div class="funkyradio-success w3-animate-opacity" style="width: 250px">
               <input type="radio" name="religion" id="religion{{ forloop.counter }}" value="{{ religion.id }}" />
               <label for="religion{{ forloop.counter }}">{{ religion.religion_text }}</label><br />
            </div>
            {% endfor %}
            <br />

            <!-- Display the radio buttons to let users vote -->
            <strong class="w3-animate-opacity">Ethnicity:</strong><br />
            {% for ethnicity in object.ethnicity_set.all|dictsortreversed:"id" %}
            <div class="funkyradio-success w3-animate-opacity" style="width: 250px">
               <input type="radio" name="ethnicity" id="ethnicity{{ forloop.counter }}" value="{{ ethnicity.id }}" />
               <label for="ethnicity{{ forloop.counter }}">{{ ethnicity.ethnicity_text }}</label><br />
            </div>
            {% endfor %}
            <br />

            <!-- Display the radio buttons to let users vote -->
            <strong class="w3-animate-opacity">Income:</strong><br />
            {% for income in object.income_set.all|dictsortreversed:"id" %}
            <div class="funkyradio-success w3-animate-opacity" style="width: 250px">
               <input type="radio" name="income" id="income{{ forloop.counter }}" value="{{ income.id }}" />
               <label for="income{{ forloop.counter }}">{{ income.income_text }}</label><br />
            </div>
            {% endfor %}
            <br />

            <!-- Display the drop down list to let users pick where they are form -->
            <strong class="w3-animate-opacity">Constituency:</strong>
            <select id="constituency" name="constituency" class="w3-animate-opacity">
               {% for constituency in object.constituency_set.all|dictsort:"id" %}
               <option name="constituency" id="constituency{{ forloop.counter }}" value="{{constituency.id}}">{{constituency.constituency_text}}</option>
               {% endfor %}
            </select>
            <br />
            <br />

            <!-- google recaptcha to stop bots from skewing results -->
            <div class="g-recaptcha" id="cap" data-sitekey="6LeQEUoUAAAAAK8gjBkv1JdP5iLQZ9IcQ9s2cNhX" data-callback="enableBtn"></div>
            <br />

            <!--Submit button -->
            <input type="submit" value="Submit" id="button1">
         </div>
      </div>
   </form>
    <!-- code to display submit button until recaptcha has been clicked -->
   <!--<script>
      document.getElementById("button1").disabled = true;

      function enableBtn(){
         document.getElementById("button1").disabled = false;
      }
      </script>-->
   <script>
       //Make sure the hole survey has been filled out and completed
      function validateForm() {
          var x = document.forms["frm"]["choice"].value;
          var y = document.forms["frm"]["gender"].value;
          var z = document.forms["frm"]["age"].value;
          var t = document.forms["frm"]["education"].value;
          var k = document.forms["frm"]["religion"].value;
          var w = document.forms["frm"]["ethnicity"].value;
          var i = document.forms["frm"]["income"].value;
          var c = document.forms["frm"]["constituency"].value;

          //if the value is null
          if (x === "") {
              alert("Vote must be entered");
              event.preventDefault();
              return false;
          }

          if (y === "") {
              alert("Gender must be entered");
              event.preventDefault();
              return false;
          }

          if (z === "") {
              alert("Age must be entered");
              event.preventDefault();
              return false;
          }

          if (t === "") {
              alert("Education must be entered");
              event.preventDefault();
              return false;
          }

          if (k === "") {
              alert("Religion must be entered");
              event.preventDefault();
              return false;
          }

          if (w === "") {
              alert("Ethnicity must be entered");
              event.preventDefault();
              return false;
          }

          if (i === "") {
              alert("Income must be entered");
              event.preventDefault();
              return false;
          }

          if (c === "") {
              alert("constituency must be entered");
              event.preventDefault();
              return false;
          }
      }
   </script>
</body>
<style>
   @import 'https://fonts.googleapis.com/css?family=Open+Sans:300';
   .flex-container {
   display: flex;
   flex-wrap: wrap;
   flex-direction: row;
   flex-basis: auto;
   justify-content: center;
   border: #fff8f8;
   }
   .funkyradio div {
   clear: both;
   overflow: hidden;
   }
   .funkyradio label {
   width: 100%;
   border-radius: 3px;
   border: 1px solid #f4f4f4 ;
   font-weight: normal;
   background-color: #f4f4f4 ;
   }
   .funkyradio input[type="radio"]:empty {
   display: none;
   }
   .funkyradio input[type="radio"]:empty ~ label{
   position: relative;
   line-height: 2.5em;
   text-indent: 3.25em;
   margin-top: 2em;
   cursor: pointer;
   -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
   user-select: none;
   }
   .funkyradio input[type="radio"]:empty ~ label:before{
   position: absolute;
   display: block;
   top: 0;
   bottom: 0;
   left: 0;
   content: '';
   width: 2.5em;
   background: #D1D3D4;
   border-radius: 3px 0 0 3px;
   }

   .funkyradio input[type="radio"]:hover:not(:checked) ~ label{
   color: #5cb85c;
   }

   .funkyradio input[type="radio"]:hover:not(:checked) ~ label:before{
   content: '\2714';
   text-indent: .9em;
   color: #5cb85c;
   }

   .funkyradio input[type="radio"]:checked ~ label{
   color: #5cb85c;
   }

   .funkyradio input[type="radio"]:checked ~ label:before{
   content: '\2714';
   text-indent: .9em;
   color: #333;
   background-color: #ccc;
   }

   .funkyradio input[type="radio"]:focus ~ label:before{
   box-shadow: 0 0 0 3px #999;
   }

   .funkyradio-success input[type="radio"]:checked ~ label:before{
   color: #fff;
   background-color: #5cb85c;
   }

   * {
   box-sizing: border-box;
   -webkit-box-sizing: border-box;
   margin: 0;
   padding: 0;
   }

   html, body {
   width: 100%;
   height: 100%;
   background-color: #3a7eb1;
   position: relative;
   }

   h1, h2 {
   font-family: verdana, sans-serif;
   color: #fff;
   text-align: center;
   }

   h2 {
   font-weight: 400;
   }

   h1 {
   font-family: 'Open Sans', serif;
   font-weight: 300;
   text-transform: uppercase;
   font-size: 3.7em;
   }

   h2 {
   font-family: 'Open Sans', serif;
   font-weight: 300;
   color: #fff;
   font-size: 1.9em;
   }

   .page-header {
   border: none;
   text-align: center;
   }

   .page-header h1 {
   margin-bottom: 6px;
   }

   .page-header h2 {
   margin-top: 0;
   }

   hr {
   height: 1px;
   border-top: 1px solid #ccc;
   margin: 1em 0;
   margin-left: 25px;
   margin-right: 25px;
   }

   strong{
   color: #f4f4f4;
   }
</style>